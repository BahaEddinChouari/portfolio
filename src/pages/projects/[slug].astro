---
import Layout from "@layouts/Layout.astro";
import { SITE_CONTENT } from "@config";

export function getStaticPaths() {
  return SITE_CONTENT.projects
    .filter((p) => Boolean(p.slug))
    .map((p) => ({ params: { slug: p.slug as string } }));
}

const { slug } = Astro.params;
const project = SITE_CONTENT.projects.find((p) => p.slug === slug);

if (!project) {
  throw new Error(`Project not found for slug: ${slug}`);
}

const { name, summary, image, details, tech, outcomes, linkSource } = project;
---

<Layout>
  <section class="mx-auto max-w-4xl px-6 py-16">
    <h1 class="mb-4 font-serif text-4xl font-semibold text-primary">{name}</h1>
    <p class="mb-8 text-lg text-neutral">{summary}</p>

    <img src={image} alt={name} class="mb-10 w-full rounded-xl border border-neutral/20" />

    {details && (
      <div class="mb-8">
        <h2 class="mb-3 text-2xl font-medium">Overview</h2>
        <ul class="list-disc space-y-2 pl-6 text-neutral">
          {(Array.isArray(details) ? details : [details]).map((d) => (
            <li>{d}</li>
          ))}
        </ul>
      </div>
    )}

    {tech && tech.length > 0 && (
      <div class="mb-8">
        <h2 class="mb-3 text-2xl font-medium">Tech</h2>
        <div class="flex flex-wrap gap-2">
          {tech.map((t) => (
            <span class="rounded-full border border-neutral/20 px-3 py-1 text-sm text-neutral">{t}</span>
          ))}
        </div>
      </div>
    )}

    {outcomes && outcomes.length > 0 && (
      <div class="mb-8">
        <h2 class="mb-3 text-2xl font-medium">Outcomes</h2>
        <ul class="list-disc space-y-2 pl-6 text-neutral">
          {outcomes.map((o) => (
            <li>{o}</li>
          ))}
        </ul>
      </div>
    )}

    <div class="mt-8">
      {linkSource && (
        <a href={linkSource} target="_blank" class="text-white hover:underline after:relative after:bottom-[-5px] after:content-[url(/external.svg)]">
          View Source
        </a>
      )}
    </div>
  </section>
</Layout>


